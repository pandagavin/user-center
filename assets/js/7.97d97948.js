(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{427:function(s,a,t){"use strict";t.r(a);var e=t(20),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"作业提交"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#作业提交"}},[s._v("#")]),s._v(" 作业提交")]),s._v(" "),t("p",[s._v("在系统中，所有在计算结点中运行的串行或并行应用程序，都必须通过资源管理系统来提交运行。资源管理系统首先将用户提交的应用程序构造成作业进行排队处理，然后根据系统的实时运行资源状态，决定何时以及在哪些计算结点中加载应用程序的运行，不同的应用程序之间不存在资源的竞争冲突，用户也可以通过作业管理系统来监控应用程序的运行。")]),s._v(" "),t("h3",{attrs:{id:"使用限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用限制"}},[s._v("#")]),s._v(" 使用限制")]),s._v(" "),t("p",[s._v("为了保证系统资源的高效使用，用户请求的快速响应，系统的稳定性，在系统中做出了相应的使用限制，相关限制如下：")]),s._v(" "),t("h4",{attrs:{id:"登陆限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#登陆限制"}},[s._v("#")]),s._v(" 登陆限制")]),s._v(" "),t("h5",{attrs:{id:"密码过期保护"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#密码过期保护"}},[s._v("#")]),s._v(" 密码过期保护")]),s._v(" "),t("p",[s._v("系统已开启密码过期保护，密码最长过期时间为 "),t("code",[s._v("180")]),s._v(" 天，在密码过期前会有即将过期的提示（提前 "),t("code",[s._v("14")]),s._v(" 天提醒），密码过期后无法登陆，请联系管理员。")]),s._v(" "),t("h5",{attrs:{id:"密码错误锁定保护"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#密码错误锁定保护"}},[s._v("#")]),s._v(" 密码错误锁定保护")]),s._v(" "),t("p",[s._v("系统已开启密码错误保护，当用户输入密码错误次数超过 "),t("code",[s._v("3")]),s._v(" 次后，系统会禁止用户登陆，锁定时间为 "),t("code",[s._v("5")]),s._v("分钟 。在锁定期间，如果再次登陆（无论密码输入正确或者错误，都无法登陆成功，并刷新最后登陆时间）。请输入错误后，等待 "),t("code",[s._v("5")]),s._v(" 分钟后再尝试。如果错误次数过多可能会导致账号锁死，需要联系管理员进行账号解锁。")]),s._v(" "),t("h4",{attrs:{id:"计算分区限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#计算分区限制"}},[s._v("#")]),s._v(" 计算分区限制")]),s._v(" "),t("p",[s._v("系统可根据用户的使用情况，对所有计算资源进行分区。不同分区针对不同的用户群体开放使用，用户可以使用使用 "),t("code",[s._v("sinfo")]),s._v(" 命令，看到相应的分区限制信息，例如：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("zhang3@ln0 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ sinfo\nPARTITION AVAIL  TIMELIMIT  NODES  STATE NODELIST\nbatch*       up   infinite     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("   idle cn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("-19"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("strong",[s._v("参数说明：")])]),s._v(" "),t("ul",[t("li",[s._v("PARTITION 表示计算分区（带有 "),t("code",[s._v("*")]),s._v(" 的计算分区表示默认分区，即提交运行作业时，不指定 "),t("code",[s._v("-p")]),s._v(" 参数时，使用的默认分区）")]),s._v(" "),t("li",[s._v("AVAIL 表示分区状态：up 开启 / down 关闭")]),s._v(" "),t("li",[s._v("TIMELIMIT 表示该分区的时间限制：格式为 "),t("code",[s._v("天-时:分:秒")]),s._v("，如果是 "),t("code",[s._v("infinite")]),s._v(" 表示没有时间限制")]),s._v(" "),t("li",[s._v("NODES 表示结点数")]),s._v(" "),t("li",[s._v("STATE 表示结点运行状态：down 表示未启动 / idle 表示启动后处于空闲状态 / allocated 表示结点已经分配作业")]),s._v(" "),t("li",[s._v("NODELIST 为结点列表")])]),s._v(" "),t("p",[s._v("根据用户所在的共享存储不同以及权限不同，能够使用的计算分区也不相同，具体如下表所示：")]),s._v(" "),t("p",[t("em",[s._v("表5 用户分区限制")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[s._v("分区名称")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("分区含义")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("运行时间(h)")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("使用权限")])])]),s._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("batch")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("包机时用户分区")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("无")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("由账号权限决定")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("其他分区")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("用户专有分区")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("由账号权限决定")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("由账号权限决定")])])])]),s._v(" "),t("p",[s._v("所有分区均可以设定相应允许的用户队列，目前分区为所有用户均可以使用；根据用户的不同分类，划分不同的资源，用户如果看不到某些分区，是因为该用户不具备相应的资源使用权限。")]),s._v(" "),t("p",[t("strong",[s._v("注意：")])]),s._v(" "),t("ol",[t("li",[s._v("由于大型集群系统具备一定故障率，为了保证系统稳定性，部分计算分区中有限定任务执行时间的限制，因此建议用户为程序设立“断点”从而保证任务由于意外中断后，可以继续运算。")]),s._v(" "),t("li",[s._v("目前系统对用户所设置的计算分区，均为共享分区，所有用户共享该分区资源。若用户需要独占资源，请提出申请。")])]),s._v(" "),t("h4",{attrs:{id:"提交作业限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#提交作业限制"}},[s._v("#")]),s._v(" 提交作业限制")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("根据用户的申请情况，针对用户的作业相关配置进行了限制，包括：最多可以使用的结点数、最多可以使用的核数、单个任务最多可以使用的结点数、单个任务最多可以使用的核数等。")])]),s._v(" "),t("li",[t("p",[s._v("通过命令"),t("code",[s._v("sacctres")]),s._v("可查看自己账号的具体权限设置。用户只有查看自己账号的权限，无查询其他账号的权限。")])]),s._v(" "),t("li",[t("p",[s._v("用户在使用过程中，如果有超出自己合同范围内的计算规模的计算需求，请基于自己的需求，向管理员提出申请，管理员会根据用户需要审查后，进行一定的修改。")])]),s._v(" "),t("li",[t("p",[s._v("为了保证系统和用户数据的安全，目前普通用户不能在没有申请资源时，就 "),t("code",[s._v("ssh")]),s._v(" 链接到计算结点，只有分配了相应的计算结点资源后，才能 "),t("code",[s._v("ssh")]),s._v(" 到指定计算结点。")])])]),s._v(" "),t("p",[s._v("举例如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("zhang3@ln0 /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ sacctres\n   Cluster    Account       User  Partition              GrpTRES GrpSubmit GrpJobs\n---------- ---------- ---------- ---------- -------------------- --------- -------\n     linux      zhang3                           "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("cpu")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("800")]),s._v(",node"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("\n     linux      zhang3    zhang3      batch\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("参数说明：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("Cluster 集群名")])]),s._v(" "),t("li",[t("p",[s._v("Account 账号所属组")])]),s._v(" "),t("li",[t("p",[s._v("User 账号名")])]),s._v(" "),t("li",[t("p",[s._v("Partition 计算分区")])]),s._v(" "),t("li",[t("p",[s._v("GrpTRES 最大使用资源数")])]),s._v(" "),t("li",[t("p",[s._v("GrpSubmitJobs 最大提交作业数")])]),s._v(" "),t("li",[t("p",[s._v("GrpJobs  最大运行作业数")])])]),s._v(" "),t("p",[s._v("用户同样可以查看到自己的限制，也可以根据后面的需要向管理员提出申请，管理员会根据用户需要重新修改限制。")]),s._v(" "),t("blockquote",[t("p",[s._v("为了保证系统和用户数据的安全，目前普通用户不能在没有申请资源时，就 "),t("code",[s._v("ssh")]),s._v(" 链接到计算结点，只有分配了相应的计算结点资源后，才能 "),t("code",[s._v("ssh")]),s._v(" 到指定计算结点。")])]),s._v(" "),t("h4",{attrs:{id:"磁盘配额限制"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#磁盘配额限制"}},[s._v("#")]),s._v(" 磁盘配额限制")]),s._v(" "),t("p",[s._v("为了合理利用有限的存储资源，目前对用户默认进行存储软限制 "),t("code",[s._v("500GB")]),s._v("，存储硬限制 "),t("code",[s._v("1TB")]),s._v("，文件数软限制 "),t("code",[s._v("100 万")]),s._v("，文件数硬限制 "),t("code",[s._v("200 万")]),s._v(" 的磁盘配额限制。")]),s._v(" "),t("p",[s._v("登陆系统后，通常就会显示该用户所属group（即用户组）的存储情况：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("Disk quotas "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" group zhang3 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("gid "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":     \n  Filesystem    used    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v("  limit   grace    files      "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v("   limit   grace\n       /work    256G     500G    1T               "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000000")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000000")]),s._v("      \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("关键词说明：")]),s._v(" "),t("ul",[t("li",[s._v("Filesystem 用户所在的共享分布式存储")]),s._v(" "),t("li",[s._v("used 用户目前已经使用的存储")]),s._v(" "),t("li",[s._v("quota 存储软限制")]),s._v(" "),t("li",[s._v("limit  存储硬限制")]),s._v(" "),t("li",[s._v("grace  存储状态，默认为空")]),s._v(" "),t("li",[s._v("files 用户已用文件数")]),s._v(" "),t("li",[s._v("quota 文件数软限制")]),s._v(" "),t("li",[s._v("limit 文件数硬限制")]),s._v(" "),t("li",[s._v("grace 文件数状态，默认为空")])]),s._v(" "),t("p",[s._v("用户可以使用命令查询查询用户组或用户的配额限制，查询命令为：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询用户组")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" -h -g zhang3 \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查询用户")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("quota")]),s._v(" -h -u zhang3 \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("命令参数说明："),t("code",[s._v("quota")]),s._v(" 是配额查询命令， "),t("code",[s._v("-h")]),s._v(" 是人性化显示查询结果， "),t("code",[s._v("-g")]),s._v(" 查询用户组， "),t("code",[s._v("-u")]),s._v(" 查询用户。")]),s._v(" "),t("blockquote",[t("p",[s._v("Tips：")]),s._v(" "),t("ol",[t("li",[s._v("存储是有配额限制的：\n"),t("ul",[t("li",[s._v("超出软限制，开启倒计时，倒计时到期就用不了了；")]),s._v(" "),t("li",[s._v("超出硬限制，直接就用不了了。")])])]),s._v(" "),t("li",[s._v("如果默认免费配额不够用，需要增加配额，请联系管理员。")])])]),s._v(" "),t("h3",{attrs:{id:"状态查看命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#状态查看命令"}},[s._v("#")]),s._v(" 状态查看命令")]),s._v(" "),t("p",[s._v("在用户提交作业前，应查看系统的使用情况，这样利于用户根据系统使用情况，对相应的计算结点进行选择。")]),s._v(" "),t("h4",{attrs:{id:"节点状态查看"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#节点状态查看"}},[s._v("#")]),s._v(" 节点状态查看")]),s._v(" "),t("p",[s._v("用户可以使用 "),t("code",[s._v("sinfo")]),s._v(" 命令查看结点的使用情况，从而根据情况做出选择。例如：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("zhang3@ln0 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ sinfo\nPARTITION AVAIL  TIMELIMIT  NODES  STATE NODELIST\nbatch*       up   infinite     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19")]),s._v("   idle cn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("-19"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("strong",[s._v("参数说明：")])]),s._v(" "),t("ul",[t("li",[s._v("PARTITION 表示计算分区（带有 "),t("code",[s._v("*")]),s._v(" 的计算分区表示默认分区，即提交运行作业时，不指定 "),t("code",[s._v("-p")]),s._v(" 参数时，使用的默认分区）")]),s._v(" "),t("li",[s._v("AVAIL 表示分区状态\n"),t("ul",[t("li",[s._v("up 开启")]),s._v(" "),t("li",[s._v("down 关闭")])])]),s._v(" "),t("li",[s._v("TIMELIMIT 表示该分区的时间限制：格式为 "),t("code",[s._v("天-时:分:秒")]),s._v("，如果是 "),t("code",[s._v("infinite")]),s._v(" 表示没有时间限制")]),s._v(" "),t("li",[s._v("NODES 表示结点数")]),s._v(" "),t("li",[s._v("STATE 表示结点运行状态\n"),t("ul",[t("li",[s._v("down 表示未启动")]),s._v(" "),t("li",[s._v("idle 表示启动后处于空闲状态")]),s._v(" "),t("li",[s._v("allocated 表示结点已经分配作业")])])]),s._v(" "),t("li",[s._v("NODELIST 为结点列表")])]),s._v(" "),t("h4",{attrs:{id:"作业状态查看"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#作业状态查看"}},[s._v("#")]),s._v(" 作业状态查看")]),s._v(" "),t("p",[s._v("用户可以使用  "),t("code",[s._v("squeue")]),s._v(" 命令查看系统中各计算结点的运行情况，例如：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("zhang3@ln0 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ squeue\n             JOBID PARTITION     NAME     "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" ST       TIME  NODES NODELIST"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("REASON"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9")]),s._v("     batch   sub.sh    gavin PD       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":00      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Resources"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v("     batch  wrf.exe    gavin  R       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":06      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" cn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("-2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n                "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v("     batch     "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("    gavin  R       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":12      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" cn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("-4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("参数说明：")]),s._v(" "),t("ul",[t("li",[s._v("JOBID 表示任务 ID")]),s._v(" "),t("li",[s._v("Name 表示任务名称")]),s._v(" "),t("li",[s._v("USER 为用户")]),s._v(" "),t("li",[s._v("ST 为作业状态（PD 排队；R 运行）")]),s._v(" "),t("li",[s._v("TIME 为已运行时间")]),s._v(" "),t("li",[s._v("NODES表示占用结点数")]),s._v(" "),t("li",[s._v("NODELIST 为任务运行的结点列表（未运行的作业会给出排队原因）")])]),s._v(" "),t("p",[s._v("用户可以使用 "),t("code",[s._v("squeue")]),s._v(" 查看自己提交的作业，为了保证用户的数据安全，普通用户通过 "),t("code",[s._v("squeue")]),s._v("只能看到自己提交的作业。")]),s._v(" "),t("p",[s._v("用户可以通过 "),t("code",[s._v("scontrol")]),s._v(" 命令来查看自己提交的作业明细，语法格式为 "),t("code",[s._v("scontrol show jobs jobid")]),s._v("（其中：jobid替换为实际的作业编号），例如：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("gavin@cn1 ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ scontrol show jobid "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JobId")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JobName")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("sub.sh\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UserId")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zhang3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GroupId")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zhang3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MCS_label")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("N/A\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Priority")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Nice")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Account")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("zhang3 "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("QOS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("normal "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WCKey")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("*hpc\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JobState")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("RUNNING "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Reason")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("None "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Dependency")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("null"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Requeue")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Restarts")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BatchFlag")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Reboot")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExitCode")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":0\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("RunTime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("00:00:10 "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TimeLimit")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("UNLIMITED "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TimeMin")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("N/A\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SubmitTime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-17T22:15:33 "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("EligibleTime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-17T22:15:33\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("AccrueTime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Unknown\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("StartTime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-17T22:15:33 "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("EndTime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Unknown "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Deadline")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("N/A\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SuspendTime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("None "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SecsPreSuspend")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("LastSchedEval")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-17T22:15:33\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Partition")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("batch AllocNode:Sid"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cn1:56233\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ReqNodeList")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("null"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ExcNodeList")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("null"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NodeList")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("-2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BatchHost")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cn1\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NumNodes")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NumCPUs")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NumTasks")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" CPUs/Task"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" ReqB:S:C:T"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":0:*:*\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TRES")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cpu"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(",node"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(",billing"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n   Socks/Node"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("* NtasksPerN:B:S:C"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(":0:*:* "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CoreSpec")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("*\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MinCPUsNode")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MinMemoryNode")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MinTmpDiskNode")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Features")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("null"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DelayBoot")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("00:00:00\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("OverSubscribe")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("OK "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Contiguous")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Licenses")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("null"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Network")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("null"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Command")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("sleep\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("WorkDir")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/work/home/zhang3\n   "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("Power")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("\n   NtasksPerTRES:0\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("blockquote",[t("p",[s._v("Tips： 使用 "),t("code",[s._v("scontrol")]),s._v(" 命令可以看到详细的作业信息，具体函数不在赘述")])]),s._v(" "),t("h3",{attrs:{id:"提交作业"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#提交作业"}},[s._v("#")]),s._v(" 提交作业")]),s._v(" "),t("p",[s._v("目前系统部署的资源管理系统包括多种作业提交方式，交互作业提交方式  "),t("code",[s._v("srun")]),s._v(" ，批处理作业提交方式 "),t("code",[s._v("sbatch")]),s._v("  和分配模式 "),t("code",[s._v("salloc")]),s._v("。作业终止方式为 "),t("code",[s._v("sancel")]),s._v("命令，需要获取作业的 "),t("code",[s._v("jobid")]),s._v("，如前所述，"),t("code",[s._v("jobid")]),s._v(" 可以通过 "),t("code",[s._v("squeue")]),s._v(" 命令查看获得。")]),s._v(" "),t("p",[s._v("系统中作业的运行分成两步：资源分配与任务加载。")]),s._v(" "),t("p",[s._v("对于不同的作业提交方式，基本流程如下：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("对于批处理作业，使用 "),t("code",[s._v("sbatch")]),s._v(" 命令提交作业脚本，作业被调度运行后，在所分配的首个结点上执行作业脚本，在作业脚本中使用 "),t("code",[s._v("srun")]),s._v(" 命令加载作业任务。")])]),s._v(" "),t("li",[t("p",[s._v("对于交互式作业，资源分配与任务加载两步均通过 "),t("code",[s._v("srun")]),s._v(" 命令进行：当在登录 shell 中执行 "),t("code",[s._v("srun")]),s._v("  命令时， "),t("code",[s._v("srun")]),s._v(" 首先向系统提交作业请求并等待资源分配，然后在所分配的结点上加载作业任务。")])]),s._v(" "),t("li",[t("p",[s._v("对于分配模式作业，使用 "),t("code",[s._v("salloc")]),s._v(" 命令向系统提交作业请求并等待资源分配，获得结点资源后返回。然后再使用 "),t("code",[s._v("srun")]),s._v(" 命令在所分配的结点上加载作业任务。")])])]),s._v(" "),t("blockquote",[t("p",[s._v("为了简化和方便用户，只对相关命令做简单介绍，用户如需更多参数选择，可通过相应命令后加入"),t("code",[s._v("--help")]),s._v(" 的方式，获取帮助信息，从而满足用户需求。")])]),s._v(" "),t("h4",{attrs:{id:"交互式作业提交"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#交互式作业提交"}},[s._v("#")]),s._v(" 交互式作业提交")]),s._v(" "),t("p",[t("code",[s._v("srun")]),s._v(" 命令运行的主要格式如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("srun "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("options"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" program \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("code",[s._v("srun")]),s._v(" 包括多个选项，用户最常使用的选项如下：")]),s._v(" "),t("ul",[t("li",[s._v("-n, --ntasks=ntasks  指定要运行的进程数。请求 srun分配/加载 ntasks 个进程。省缺的情况是每个 CPU 运行一个进程，但是 -c 参数将改变此省缺值。")]),s._v(" "),t("li",[s._v("-N, --nodes=minnodes[-maxnodes]  请求为此作业至少分配 minnodes 个结点。调度器可能决定在多于 minnodes 个结点上启动作业。可以通过指定 maxnodes 限制最多分配的结点数，如“--nodes=2-4”。最少和最多结点数可以相同以便指定确切的结点数，如“--nodes=2-2”将请求两个并且仅仅两个结点。如果没有指定-N，省缺的行为是分配足够的结点以满足-n 选项的要求。")]),s._v(" "),t("li",[s._v("-p, --partition=partition 从分区 partition 请求资源。如未指定，则省缺为默认分区。")]),s._v(" "),t("li",[s._v("-t, --time=minutes 设置作业的运行时间限制为 minutes 分钟。省缺值为分区的时间限制值。当到达时间限制时，作业的进程将被发送 SIGTERM 以及 SIGKILL 信号终止执行。")]),s._v(" "),t("li",[s._v("-D, --chdir=path 加载的作业进程在执行前将工作目录改变到 path 。省缺情况下作业 srun进程的当前工作目录。")]),s._v(" "),t("li",[s._v("-l, --label 在标准输出/标准错误的每行之前添加任务号。通常，远程任务的标准输出和标准错误通过行缓冲直接传递到 srun的标准输出和标准错误。--label 选项将在每行输出前面添加远程任务的 ID。")]),s._v(" "),t("li",[s._v("-J, --job-name=jobname 指定作业的名字。省缺值是可执行程序的名字 program 。")]),s._v(" "),t("li",[s._v("-W, --wait=seconds 指定在第一个任务退出后，到终止所有剩余任务之前的等待时间。0 表示无限等待（60 秒后将发出一个警告）。省缺值可由系统配置文件中的参数设置。此选项用于确保作业在一个或多个任务提前退出时能够及时终止。")]),s._v(" "),t("li",[s._v("-w, --nodelist=nodelist|filename 请求指定列表中的结点。分配给作业的将至少包含这些结点。nodelist 可以是逗号分割的结点列表或范围表达式（如 cn[1-5,7,12]）。如果包含“/”字符，则 nodelist 将会被当作是一个文件名，其中包含了所请求的结点列表。")]),s._v(" "),t("li",[s._v("-x, --execlude=nodelist|filename 排除指定列表中的结点。分配给作业的将不会包含这些结点。")]),s._v(" "),t("li",[s._v("--exclusive 此作业不能与其它运行的作业共享结点，加入此选项，则表示用户需要针对此作业使用独占的处理器，如果没有足够的处理器，则作业的启动将会被推迟。")])]),s._v(" "),t("blockquote",[t("p",[s._v("Tips以上选项中，由以 "),t("code",[s._v("-N")]),s._v(" ，"),t("code",[s._v("-n")]),s._v("，"),t("code",[s._v("-p")]),s._v("，"),t("code",[s._v("-w")]),s._v("，"),t("code",[s._v("-x")]),s._v(" 等选项最常用，"),t("code",[s._v("-N")]),s._v(" 指定结点数，"),t("code",[s._v("-n")]),s._v(" 指定进程数，"),t("code",[s._v("-p")]),s._v(" 指定分区名，"),t("code",[s._v("-w")]),s._v(" 指定结点列表，"),t("code",[s._v("-x")]),s._v(" 指定不参加分配的结点列表（用于排除自己认为有问题的结点）。")])]),s._v(" "),t("p",[s._v("系统的资源使用 "),t("strong",[s._v("非抢占式调度方式")]),s._v("，即作业如果没有占满结点，则如有别的作业提出需求，若剩余资源合适，也会将资源分配给新的作业。例如一个作业占用了一个结点的 "),t("code",[s._v("4")]),s._v(" 核，另外有新的作业也需要 "),t("code",[s._v("4")]),s._v(" 核，则该作业也会分配在该结点上。")]),s._v(" "),t("p",[t("strong",[s._v("特别注意：")])]),s._v(" "),t("ol",[t("li",[t("p",[t("code",[s._v("srun")]),s._v(" 基本可以替代 "),t("code",[s._v("mpirun")]),s._v(" ，特别是使用 "),t("code",[s._v("Intel IMPI")]),s._v(" 编译的程序，完全可以使用 "),t("code",[s._v("srun")]),s._v(" 提交任务，而不需使用 "),t("code",[s._v("mpirun")]),s._v("。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("srun")]),s._v(" 为交互式作业提交方式，用户如需要和程序进行交互，则选择直接使用 "),t("code",[s._v("srun")]),s._v(" 提交任务，如果不需要交互，则需使用批处理作业提交方式。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("srun")]),s._v(" 提交的任务，如果没有进行输入输出的重定向，在关闭登陆客户端软件时，会导致任务中断，因此如无特殊需要，请直接使用 "),t("code",[s._v("srun")]),s._v(" 提交任务时，重定向输入输出，并保留相应的 "),t("code",[s._v("log")]),s._v(" 文件，方便遇到问题时，技术人员及时解决。")])])]),s._v(" "),t("p",[s._v("重定向举例如下：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("srun –p batch –N 2 –n 160 ./a.out >log 2>&1 & \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("说明："),t("code",[s._v(">")]),s._v(" 为重定向符号，"),t("code",[s._v("2>&1")]),s._v(" 表示标准错误输出重定向至标准输出，最后的 "),t("code",[s._v("&")]),s._v(" 表示后台提交方式，这样保证了该任务在登陆客户端关闭时依然保持不中断。")]),s._v(" "),t("blockquote",[t("p",[s._v("Tips：再次提示，为了保证任务的稳定性，如无特殊需要请使用批处理作业提交方式")])]),s._v(" "),t("h4",{attrs:{id:"批处理作业提交"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#批处理作业提交"}},[s._v("#")]),s._v(" 批处理作业提交")]),s._v(" "),t("p",[s._v("由于交互需求，才考虑直接使用 "),t("code",[s._v("srun")]),s._v(" 提交任务。如无交互需求，或不能直接使用 "),t("code",[s._v("srun")]),s._v(" 提交任务，请使用批处理作业提交任务。")]),s._v(" "),t("p",[s._v("批处理作业是指用户编写作业脚本，指定资源需求约束，然后作为作业提交。提交批处理作业的命令为 "),t("code",[s._v("sbatch")]),s._v(" ，用户提交命令后即执行结束，返回命令行窗口，但此时作业在进行排队调度，在资源需求被满足是，分配完计算结点之后，系统将在所分配的第一个计算结点上加载执行用户的作业脚本。")]),s._v(" "),t("p",[s._v("批处理作业使用 "),t("code",[s._v("sbatch")]),s._v(" 命令提交，用户在 "),t("code",[s._v("sbatch")]),s._v(" 的参数中指定资源分配的需求约束，编写的作业脚本中，也可以使用 "),t("code",[s._v("srun")]),s._v(" 命令加载计算作业，此时 srun通过环境变量感知已经分配了资源，从而直接创建作业而不再次提交作业。")]),s._v(" "),t("p",[s._v("批处理作业的脚本为一个文本文件，脚本第一行以 "),t("code",[s._v("#!")]),s._v("字符开头，并制定脚本文件的解释程序，如 "),t("code",[s._v("sh")]),s._v("，"),t("code",[s._v("bash")]),s._v("，"),t("code",[s._v("rsh")]),s._v(" ，"),t("code",[s._v("csh")]),s._v(" 等。")]),s._v(" "),t("p",[s._v("这种作业提交方式，适合那些需要指定资源，且带有自己执行命令的计算作业，或者需要连续执行多个任务的作业，用户可以在脚本中提交多个任务，逐个计算。")]),s._v(" "),t("p",[s._v("计算完成后，工作目录中会生成以 "),t("code",[s._v("slurm")]),s._v(" 开头的 "),t("code",[s._v(".out")]),s._v(" 文件为输出文件。")]),s._v(" "),t("p",[s._v("如前所述，系统中作业的运行分成两步：资源分配与任务加载。批处理作业使用 "),t("code",[s._v("sbatch")]),s._v(" 提交脚本的方式运行，"),t("code",[s._v("sbatch")]),s._v(" 负责资源分配，"),t("code",[s._v("sbatch")]),s._v(" 获取资源后，会在获取资源的第一个结点运行提交的脚本。")]),s._v(" "),t("blockquote",[t("p",[t("code",[s._v("sbatch")]),s._v(" 包含多个选项，基本和 "),t("code",[s._v("srun")]),s._v(" 类似，用户可以通过 "),t("code",[s._v("sbatch --help")]),s._v(" 命令查看相应所需参数。")])]),s._v(" "),t("p",[t("strong",[s._v("举例一：")])]),s._v(" "),t("p",[s._v("用户的脚本为 "),t("code",[s._v("sub.sh")]),s._v(" 如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash ")]),s._v("\nsrun -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(" –p batch –w cn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("-2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("根据该脚本用户提交批处理作业，需要明确申请的资源为 "),t("code",[s._v("batch")]),s._v(" 分区的结点 "),t("code",[s._v("cn[1-2]")]),s._v("，因此用户提交如下的批处理命令即可：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("sbatch –p batch –w cn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("-2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ./mybash.sh \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("TIps：此时注意，给文本文件可执行权限，利用 chmod 命令，使用为：chmod +x filename（其中 filename 替换为你需要修改的文件名。）")])]),s._v(" "),t("p",[t("strong",[s._v("举例二 :")])]),s._v(" "),t("p",[t("code",[s._v("sbatch")]),s._v(" 提交的脚本中即可以包含 "),t("code",[s._v("srun")]),s._v("，也可以支持 "),t("code",[s._v("mpirun")]),s._v(" 等提交作业方式。")]),s._v(" "),t("p",[s._v("例如，希望使用 "),t("code",[s._v("mpirun")]),s._v(" 命令运行可执行程序 "),t("code",[s._v("a.out")]),s._v("，需要运行在结点 "),t("code",[s._v("cn1-cn10")]),s._v("，共计 "),t("code",[s._v("10")]),s._v(" 个结点  "),t("code",[s._v("800")]),s._v(" 个进程。则可以撰写脚本 sub.sh 如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash ")]),s._v("\nsrun -N "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("800")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" hostfile\nmpirun –hostfile hostfile –np "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("800")]),s._v(" ./a.out\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("blockquote",[t("p",[s._v("TIps：第二行是创建供 "),t("code",[s._v("mpirun")]),s._v(" 命令使用的 hostfile文件。")])]),s._v(" "),t("p",[s._v("用户根据该脚本（chmod 修改该脚本可执行权限 chmod +x sub.sh），提交批处理命令如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("sbatch –N "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("800")]),s._v(" –p batch –w cn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("-10"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" ./sub.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("特别提示：")]),s._v(" "),t("blockquote",[t("p",[s._v("Tips：批处理作业提交模式，试用范围很广，由于手册篇幅限制，不能详述，如果您在提交批处理作业的过程中遇到了任何问题，请联系管理员。")])]),s._v(" "),t("h4",{attrs:{id:"分配模式作业提交"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分配模式作业提交"}},[s._v("#")]),s._v(" 分配模式作业提交")]),s._v(" "),t("p",[s._v("分配作业模式类似于，交互式作业模式和批处理作业模式的融合。用户需要指定资源分配的需求条件，向资源管理器提出作业的资源分配请求。作业排队，当用户请求资源被满足时，将在用户提交作业的结点上，执行用户所指定的命令，指定的命令执行结束后，也运行结束，用户申请的资源被释放。")]),s._v(" "),t("p",[t("code",[s._v("salloc")]),s._v(" 后面如果没有跟定相应的脚本或可执行文件，则默认选择了"),t("code",[s._v("/bin/sh")]),s._v("，用户获得了一个合适环境变量的 "),t("code",[s._v("shell")]),s._v("  环境。")]),s._v(" "),t("p",[t("code",[s._v("salloc")]),s._v(" 和 "),t("code",[s._v("sbatch")]),s._v(" 最主要的区别是，"),t("code",[s._v("salloc")]),s._v("命令资源请求被满足时，直接在提交作业的结点执行相应任务。而 sbatch则当资源请求被满足时，在分配的第一个结点上执行相应任务。")]),s._v(" "),t("p",[t("code",[s._v("salloc")]),s._v(" 在分配资源后，再执行相应的任务，很适合需要指定运行结点，和其它资源限制，并有特定命令的作业。")]),s._v(" "),t("p",[t("code",[s._v("salloc")]),s._v(" 包含多个选项，基本和 "),t("code",[s._v("srun")]),s._v(" 类似，用户可以通过 "),t("code",[s._v("salloc--help")]),s._v(" 命令查看相应所需参数。")]),s._v(" "),t("p",[t("strong",[s._v("举例：")])]),s._v(" "),t("p",[s._v("比如"),t("code",[s._v("zhang3")]),s._v(" 用户需要 "),t("code",[s._v("2")]),s._v(" 个结点，"),t("code",[s._v("160")]),s._v(" 个进程，利用 "),t("code",[s._v("salloc")]),s._v(" 进行提交方式。")]),s._v(" "),t("p",[s._v("首先申请资源，执行如下命令：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("salloc –N "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" –n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("160")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("通过 "),t("code",[s._v("squeue")]),s._v(" 查看相应的 jobID 为 "),t("code",[s._v("1")]),s._v("，结点为 "),t("code",[s._v("cn[1-2]")]),s._v(",则用户可以选择如下方式：")]),s._v(" "),t("div",{staticClass:"language-basj line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("ssh cn1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("切换到 "),t("code",[s._v("cn1")]),s._v("  结点，之后执行如下命令：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("mpirun -machines cn1:80:cn2:80 ./a.out\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("ol",[t("li",[t("p",[t("code",[s._v("salloc")]),s._v("和 "),t("code",[s._v("sbatch")]),s._v("的使用方法类似，主要区别为任务加载点不同，"),t("code",[s._v("salloc")]),s._v(" 命令资源请求被满足时，直接在提交作业的结点执行相应任务。而 "),t("code",[s._v("sbatch")]),s._v(" 则当资源请求被满足时，在分配的第一个结点上执行相应任务。")])]),s._v(" "),t("li",[t("p",[t("code",[s._v("salloc")]),s._v("提交的作业，如果需要关闭客户端，请重定向输入输出，并后台提交。")])])])]),s._v(" "),t("h3",{attrs:{id:"作业提交举例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#作业提交举例"}},[s._v("#")]),s._v(" 作业提交举例")]),s._v(" "),t("p",[s._v("以编写 "),t("code",[s._v("sub.sh")]),s._v(" 作业提交脚本，通过 "),t("code",[s._v("sbatch")]),s._v(" 命令提交的方式为例，介绍常见的作业提交方式。")]),s._v(" "),t("h4",{attrs:{id:"串行程序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#串行程序"}},[s._v("#")]),s._v(" 串行程序")]),s._v(" "),t("p",[s._v("用户可执行文件为 "),t("code",[s._v("a.out")]),s._v("，串行程序只能使用 "),t("code",[s._v("1")]),s._v(" 个计算核心。编写提交脚本 "),t("code",[s._v("sub.sh")]),s._v(" 如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\nsrun -N "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -p batch ./a.out\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("使用 "),t("code",[s._v("sbatch")]),s._v(" 命令提交：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("sbatch -N "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -p batch ./sub.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"多线程程序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#多线程程序"}},[s._v("#")]),s._v(" 多线程程序")]),s._v(" "),t("p",[s._v("假设用户程序支持多线程（例如openMP方式），其可执行文件为 "),t("code",[s._v("a.out")]),s._v(" ，需使用 80 个 "),t("code",[s._v("openMP")]),s._v(" 多线程并行计算。编写提交脚本 sub.sh 如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("OMP_NUM_THREADS")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\nsrun -N "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -c "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v(" -p batch ./a.out\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("使用 "),t("code",[s._v("sbatch")]),s._v(" 命令提交：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("sbatch -N "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" -p batch ./sub.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:""}},[t("a",{staticClass:"header-anchor",attrs:{href:"#"}},[s._v("#")])]),s._v(" "),t("h4",{attrs:{id:"mpi程序-srun方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mpi程序-srun方式"}},[s._v("#")]),s._v(" MPI程序（srun方式）")]),s._v(" "),t("p",[s._v("假设用户可执行文件为 "),t("code",[s._v("a.out")]),s._v("，需使用 "),t("code",[s._v("160")]),s._v(" 个进程并行计算，编写提交脚本 "),t("code",[s._v("sub.sh")]),s._v(" 如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\nsrun -N "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("160")]),s._v(" -p batch ./a.out\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("使用 "),t("code",[s._v("sbatch")]),s._v(" 命令提交：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("sbatch -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v(" -p debug sub.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("Tips："),t("code",[s._v("sbatch")]),s._v(" 申请的资源必须"),t("strong",[s._v("大于或等于（推荐）")]),t("code",[s._v("sub.sh")]),s._v(" 脚本中"),t("code",[s._v("srun")]),s._v("申请的资源。")])]),s._v(" "),t("h4",{attrs:{id:"mpi程序-mpirun方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mpi程序-mpirun方式"}},[s._v("#")]),s._v(" MPI程序（mpirun方式）")]),s._v(" "),t("p",[s._v("如果用户自行编译 "),t("code",[s._v("MPI")]),s._v(" 并且没有支持 "),t("code",[s._v("slurm")]),s._v("作业调度系统接口，那么在提交并行任务时，只能使用 "),t("code",[s._v("mpirun")]),s._v(" 命令运行。")]),s._v(" "),t("p",[s._v("假设用户可执行文件为 "),t("code",[s._v("a.out")]),s._v("，需使用 "),t("code",[s._v("160")]),s._v(" 个进程并行计算，编写提交脚本 "),t("code",[s._v("sub.sh")]),s._v(" 如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\nsrun -N "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("160")]),s._v(" -p batch "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("hostname")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" hostlist\nmpirun -N "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("160")]),s._v(" -hostfile hostlist ./a.out\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("使用 "),t("code",[s._v("sbatch")]),s._v(" 命令提交：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("sbatch -N "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("160")]),s._v(" -p batch ./sub.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h4",{attrs:{id:"mpi-多进程程序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mpi-多进程程序"}},[s._v("#")]),s._v(" MPI + 多进程程序")]),s._v(" "),t("p",[s._v("如果用户的程序支持该并行方式，若用户可执行文件为 "),t("code",[s._v("a.out")]),s._v("，需使用 "),t("code",[s._v("40")]),s._v(" 个MPI进程并行计算，每个进程下开启 "),t("code",[s._v("8")]),s._v(" 个 "),t("code",[s._v("openMP")]),s._v(" 线程，则应使用的计算结点数为  "),t("code",[s._v("40 * 8 / 80 = 4")]),s._v("。编写提交脚本 "),t("code",[s._v("sub.sh")]),s._v(" 如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bashexport OMP_NUM_THREADS=6srun-N 12 -n 24 -c 6 -p debug a.out")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("使用 "),t("code",[s._v("sbatch")]),s._v(" 命令提交：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("sbatch -N "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" -n "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("40")]),s._v(" -p batch ./sub.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[s._v("Tips：结点数 = 40个MPI进程 *****  8个openMP线程/进程 "),t("strong",[s._v("/")]),s._v("  80个CPU核心/结点")])]),s._v(" "),t("h4",{attrs:{id:"另一种格式的脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#另一种格式的脚本"}},[s._v("#")]),s._v(" 另一种格式的脚本")]),s._v(" "),t("p",[s._v("用户可以编译一个包含 "),t("code",[s._v("SBATCH")]),s._v(" 命令参数的脚本，然后在使用 "),t("code",[s._v("sbatch")]),s._v(" 提交任务时，仅给出脚本名称即可。举例如下：")]),s._v(" "),t("p",[s._v("编写一个脚本文件 "),t("code",[s._v("sub.sh")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH -J helloworld")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH -p batch")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH -N 4")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH -n 160")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH -o %j.out")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH -e %j.err")]),s._v("\n\nsrun ./a.out\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("或者")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --job-name=helloworld")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --partition=batch")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --nodes=4")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --ntasks=160")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --output=%j.out")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#SBATCH --error=%j.err")]),s._v("\n\nsrun ./a.out\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("p",[s._v("然后直接运行提交脚本的命令即可：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("sbatch sub.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"作业取消"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#作业取消"}},[s._v("#")]),s._v(" 作业取消")]),s._v(" "),t("p",[s._v("用户可以使用 "),t("code",[s._v("scancel")]),s._v(" 命令取消自己的作业或作业步。")]),s._v(" "),t("p",[t("code",[s._v("scancel")]),s._v(" 命令格式为：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("scancel jobid\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("strong",[s._v("举例如下：")])]),s._v(" "),t("p",[s._v("如果提交作业后，如果正常结束，那么在"),t("code",[s._v("slurm-jobid.out")]),s._v("文件中并不会有任务的报错信息。")]),s._v(" "),t("p",[s._v("如果任务已经提交，想将它取消，可以使用 "),t("code",[s._v("yhcancel")]),s._v(" 命令，步骤如下：")]),s._v(" "),t("p",[s._v("1）确定任务编号")]),s._v(" "),t("p",[s._v("我们用"),t("code",[s._v("yhq")]),s._v("命令查看任务编号，比如为")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("     JOBID    PARTITION        NAME     "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v("    ST  TIME      NODES NODELIST"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("REASON"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("        batch      sub.sh     zhang3  R   00:15:00  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("     cn"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("-2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("2）通过任务编号取消任务")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("scancel "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("strong",[s._v("执行 "),t("code",[s._v("scancel")]),s._v(" 时候发生了什么：")])]),s._v(" "),t("ul",[t("li",[t("p",[s._v("对于排队作业，取消作业将简单地把作业标记为 "),t("code",[s._v("CANCELLED")]),s._v(" 状态而结束作业。")])]),s._v(" "),t("li",[t("p",[s._v("对于运行中或挂起的作业，取消作业将终止作业的所有作业步，包括批处理作业脚本，将作业标记为 "),t("code",[s._v("CANCELLED")]),s._v(" 状态，并回收分配给作业的结点。一般地：")]),s._v(" "),t("ul",[t("li",[s._v("批处理作业将会马上终止；")]),s._v(" "),t("li",[s._v("交互作业的 "),t("code",[s._v("srun")]),s._v(" 进程将会感知到任务的退出而终止；")]),s._v(" "),t("li",[s._v("分配模式作业的"),t("code",[s._v("salloc")]),s._v(" 进程不会自动退出，除非作业所执行的用户命令因作业或任务的结束而终止。但是在作业被取消时，控制进程都会发送通知消息给分配资源的 "),t("code",[s._v("srun")]),s._v(" 或 "),t("code",[s._v("salloc")]),s._v(" 进程。")])])])])])}),[],!1,null,null,null);a.default=n.exports}}]);